{% load static %}

<head>
  <meta id="_csrf" name="_csrf" content="{{csrf.token}}"/>
  <meta id="_csrf_header" name="_csrf_header" content="{{csrf.headerName}}"/>
</head>

<h3>video 태그는 속성 설정할때 controls(재생바 필요하면), muted(필수), autoplay(필수), loop(반복재생하려면 필수)</h3>

<div>https 붙은 외부 링크 가져다 쓰기(controls 끈 경우)</div>
<video src="https://rpnrhjwrzmbe18734976.cdn.ntruss.com/NIA_SL_WORD0066_REAL18_F.mp4" width="500px" autoplay="autoplay" muted="muted" loop="loop"></video>

<h3>---------------------(방식1: static, media 모두 가능, 경로 맨 앞에 슬래쉬로 시작!)-----------------</h3>

<div>템플릿문법 안쓰고(동영상, 미디어)</div>
<video src="/media/translate/7176006.mp4" width="500px" height="500px" controls="controls" autoplay="autoplay" muted="muted" loop="loop"></video>

<div>템플릿문법 안쓰고(이미지, 미디어)</div>
<img src="/media/lectures/gettime.jpg" width="500px" height="500px"/>

<div>템플릿문법 안쓰고(이미지, 스태틱)</div>
<img src="/static/image/main1.png" width="500px" height="500px"/>

<h3>---------------------(방식2: static만 됨)-----------------</h3>

<div>템플릿문법 쓰기(이미지, 스태틱)</div>
<img src="{% static 'image/main1.png' %}" width="500px" height="500px"/>

<h2>결론: 스태틱은 템플릿문법, 미디어는 슬래쉬로 시작하는 상대경로</h2>

<h3>----------------(중요: fetch 요청 날려서 그 결과의 주소를 활용하기)------------------</h3>

<h3 id="test_title"></h3>
<img id="test_image_tag" width="500px" height="500px"/>

<script>
  let lecture_id = 2;

  // 여기선 설명하려고 lectur_id를 직접 설정했지만 원래 설정하는 법은
  // 각자의 html 파일에서 <script> 태그를 열고
  // var lecture_id = "{{lecture_id}}";
  // 이렇게 써놔야함
  // 그리고 바로 아래에 적힌 코드들은 자바스크립트 파일에 옮겨서 적으면 됨

  let img_element = document.getElementById("test_image_tag");
  let title_element = document.getElementById("test_title");

  fetch("http://101.101.209.37/api/lecture/" + lecture_id + "/")
    .then((응답) => 응답.json())
    .then((결과) => {
      title_element.innerHTML = 결과.name; // 이렇게 점 찍으면 값을 빼올 수 있음! ex) 결과.name ex) 결과.media_entries[6].image_url 등
      img_element.src = 결과.lecture_img;
    });

  function getCookie(name) {
    var cookieValue = null;
    if (document.cookie && document.cookie != '') {
      var cookies = document
        .cookie
        .split(';');
      for (var i = 0; i < cookies.length; i++) {
        var cookie = cookies[i].trim();
        // Does this cookie string begin with the name we want?
        if (cookie.substring(0, name.length + 1) == (name + '=')) {
          cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
          break;
        }
      }
    }
    return cookieValue;
  }

  fetch('http://101.101.209.37/api/logout/')
    .then((response) => response.json())
    .then((data) => {
      console.log("로그아웃 중")
      console.log(data)
    })

  fetch('http://101.101.209.37/api/login/', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/x-www-form-urlencoded'
    },
    body: new URLSearchParams({username: "lmj2010129", password: "1234"})
  })
    .then((response) => response.json())
    .then((data) => {
      console.log("로그인 정보")
      console.log(data);
    });

  var csrftoken = getCookie('csrftoken');
  console.log(csrftoken);
  fetch('http://101.101.209.37/api/signup/', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/x-www-form-urlencoded',
      'X-CSRF-Token': csrftoken
    },
    body: new URLSearchParams({username: "lmjee2010129", password: "1234", name: "민재", phone_number: "010-1234-1234"})
  })
    .then((response) => response.json())
    .then((data) => {
      console.log("새로운 회원 가입")
      console.log(data);
    });
</script>
